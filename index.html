<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracker: Hábitos Atómicos</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Iconos Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Estilos personalizados para animaciones suaves */
        .transition-width {
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Estilo para el checkbox personalizado */
        .check-btn:hover .icon-circle { opacity: 0; }
        .check-btn:hover .icon-check { opacity: 0.5; }
        .check-btn.completed .icon-circle { display: none; }
        .check-btn.completed .icon-check { display: block; opacity: 1; color: #22c55e; transform: scale(1.1); }
        .check-btn:not(.completed) .icon-check { display: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans pb-12">

    <!-- Header Fijo -->
    <div class="sticky top-0 z-10 bg-white shadow-sm border-b border-slate-200">
        <div class="max-w-3xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between mb-2">
                <h1 class="text-xl font-bold text-slate-900 flex items-center gap-2">
                    <i data-lucide="book-open" class="w-6 h-6 text-amber-500"></i>
                    Tracker: Hábitos Atómicos
                </h1>
                <span id="progress-text" class="text-sm font-semibold text-amber-600 bg-amber-50 px-3 py-1 rounded-full">
                    0% Completado
                </span>
            </div>
            
            <!-- Barra de Progreso -->
            <div class="w-full bg-slate-200 rounded-full h-2.5">
                <div id="progress-bar" class="bg-amber-500 h-2.5 rounded-full transition-width" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <div class="max-w-3xl mx-auto px-4 mt-6">
        <!-- Intro Card -->
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-8 fade-in">
            <h2 class="text-lg font-semibold mb-2">¿Cómo usar este tracker?</h2>
            <p class="text-slate-600 text-sm">
                Esta herramienta guarda tu progreso automáticamente en este navegador.
                Haz clic en el botón <span class="inline-flex items-center bg-amber-100 text-amber-700 rounded px-1.5 py-0.5 text-xs font-bold"><i data-lucide="play" class="w-3 h-3 mr-1"></i> Ver</span> para ir al minuto exacto en YouTube. 
                Marca el círculo a la izquierda cuando termines un capítulo.
            </p>
        </div>

        <!-- Contenedor de la lista -->
        <div id="app-container" class="space-y-8">
            <!-- El contenido se generará aquí con JavaScript -->
        </div>

        <!-- Footer -->
        <div class="mt-12 mb-8 text-center text-slate-400 text-xs fade-in">
            <p>Basado en el audiolibro de James Clear. Tiempos aproximados.</p>
        </div>
    </div>

    <!-- Lógica de la Aplicación -->
    <script>
        // Datos del libro
        const sections = [
            {
                title: "Introducción",
                items: [
                    { id: 0, title: "Introducción: Mi historia", start: "00:00:00", end: "00:26:50", seconds: 0 }
                ]
            },
            {
                title: "Principios Fundamentales",
                items: [
                    { id: 1, title: "1. El sorprendente poder de los hábitos atómicos", start: "00:27:05", end: "01:05:30", seconds: 1625 },
                    { id: 2, title: "2. La manera en que tus hábitos moldean tu identidad", start: "01:05:30", end: "01:36:11", seconds: 3930 },
                    { id: 3, title: "3. Cómo construir mejores hábitos en 4 pasos", start: "01:36:11", end: "02:07:09", seconds: 5771 }
                ]
            },
            {
                title: "Primera Ley: Hacerlo Obvio",
                items: [
                    { id: 4, title: "4. El hombre que no se veía bien", start: "02:07:09", end: "02:26:54", seconds: 7629 },
                    { id: 5, title: "5. La mejor manera de comenzar un nuevo hábito", start: "02:26:54", end: "02:50:02", seconds: 8814 },
                    { id: 6, title: "6. La motivación está sobrevalorada", start: "02:50:02", end: "03:12:44", seconds: 10202 },
                    { id: 7, title: "7. El secreto del autocontrol", start: "03:12:44", end: "03:23:53", seconds: 11564 }
                ]
            },
            {
                title: "Segunda Ley: Hacerlo Atractivo",
                items: [
                    { id: 8, title: "8. Cómo lograr que un hábito sea irresistible", start: "03:24:07", end: "03:49:54", seconds: 12247 },
                    { id: 9, title: "9. El papel de la familia y los amigos", start: "03:49:54", end: "04:14:32", seconds: 13794 },
                    { id: 10, title: "10. Cómo localizar y arreglar malos hábitos", start: "04:14:32", end: "04:36:52", seconds: 15272 }
                ]
            },
            {
                title: "Tercera Ley: Hacerlo Sencillo",
                items: [
                    { id: 11, title: "11. Avanza despacio, pero no des marcha atrás", start: "04:37:06", end: "04:49:33", seconds: 16626 },
                    { id: 12, title: "12. La ley del menor esfuerzo", start: "04:49:33", end: "05:13:20", seconds: 17373 },
                    { id: 13, title: "13. Cómo dejar de postergar (Regla de 2 min)", start: "05:13:20", end: "05:30:02", seconds: 18800 },
                    { id: 14, title: "14. Cómo hacer inevitables los buenos hábitos", start: "05:30:02", end: "05:47:05", seconds: 19802 }
                ]
            },
            {
                title: "Cuarta Ley: Hacerlo Satisfactorio",
                items: [
                    { id: 15, title: "15. La regla cardinal del cambio de conducta", start: "05:47:18", end: "06:14:37", seconds: 20838 },
                    { id: 16, title: "16. Cómo mantener los buenos hábitos todos los días", start: "06:14:37", end: "06:39:28", seconds: 22477 },
                    { id: 17, title: "17. Cómo un socio corresponsable cambia todo", start: "06:39:28", end: "06:54:29", seconds: 23968 }
                ]
            },
            {
                title: "Tácticas Avanzadas",
                items: [
                    { id: 18, title: "18. La verdad acerca del talento", start: "06:54:43", end: "07:23:04", seconds: 24883 },
                    { id: 19, title: "19. La regla de Ricitos de Oro", start: "07:23:04", end: "07:41:26", seconds: 26584 },
                    { id: 20, title: "20. El inconveniente de crear buenos hábitos", start: "07:41:26", end: "08:06:22", seconds: 27686 }
                ]
            },
            {
                title: "Conclusión",
                items: [
                    { id: 21, title: "Conclusión: El secreto para resultados que duren", start: "08:06:22", end: "08:11:42", seconds: 29182 }
                ]
            }
        ];

        // Estado inicial
        let completed = JSON.parse(localStorage.getItem('atomicHabitsProgressHTML')) || [];
        const totalItems = sections.reduce((acc, section) => acc + section.items.length, 0);

        // Funciones principales
        function toggleComplete(id) {
            if (completed.includes(id)) {
                completed = completed.filter(item => item !== id);
            } else {
                completed.push(id);
            }
            saveAndRender();
        }

        function openVideo(seconds) {
            window.open(`https://youtu.be/CgGiyfv7Xpc?t=${seconds}s`, '_blank');
        }

        function saveAndRender() {
            localStorage.setItem('atomicHabitsProgressHTML', JSON.stringify(completed));
            updateProgressUI();
            renderList();
        }

        function updateProgressUI() {
            const percentage = Math.round((completed.length / totalItems) * 100);
            document.getElementById('progress-bar').style.width = `${percentage}%`;
            document.getElementById('progress-text').innerText = `${percentage}% Completado`;
        }

        function renderList() {
            const container = document.getElementById('app-container');
            container.innerHTML = '';

            sections.forEach((section, index) => {
                const sectionEl = document.createElement('div');
                sectionEl.className = 'fade-in';
                
                // Título de la sección
                const header = document.createElement('h3');
                header.className = 'text-sm font-bold text-slate-500 uppercase tracking-wider mb-3 ml-1';
                header.innerText = section.title;
                sectionEl.appendChild(header);

                // Contenedor de items
                const listContainer = document.createElement('div');
                listContainer.className = 'bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden';

                section.items.forEach(item => {
                    const isCompleted = completed.includes(item.id);
                    
                    const itemEl = document.createElement('div');
                    itemEl.className = `group flex items-center justify-between p-4 border-b border-slate-100 last:border-0 hover:bg-slate-50 transition-colors ${isCompleted ? 'bg-amber-50/30' : ''}`;
                    
                    itemEl.innerHTML = `
                        <div class="flex items-center gap-4 flex-1 cursor-pointer" onclick="toggleComplete(${item.id})">
                            <button class="check-btn flex-shrink-0 transition-all duration-200 text-slate-300 hover:text-slate-400 ${isCompleted ? 'completed' : ''}">
                                <i data-lucide="circle" class="w-6 h-6 icon-circle"></i>
                                <i data-lucide="check-circle" class="w-6 h-6 icon-check"></i>
                            </button>
                            
                            <div class="flex-1">
                                <p class="font-medium text-base transition-colors ${isCompleted ? 'text-slate-400 line-through decoration-slate-300' : 'text-slate-800'}">
                                    ${item.title}
                                </p>
                                <div class="flex items-center gap-2 mt-1">
                                    <span class="text-xs font-mono text-slate-500 bg-slate-100 px-2 py-0.5 rounded">
                                        ${item.start} - ${item.end}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <button onclick="openVideo(${item.seconds})" 
                                class="ml-4 p-2 bg-amber-100 text-amber-700 rounded-full hover:bg-amber-500 hover:text-white transition-all shadow-sm group-hover:shadow-md flex items-center gap-2"
                                title="Ver en YouTube">
                            <i data-lucide="play" class="w-4 h-4 fill-current"></i>
                            <span class="text-xs font-bold hidden sm:inline">Ver</span>
                        </button>
                    `;
                    listContainer.appendChild(itemEl);
                });

                sectionEl.appendChild(listContainer);
                container.appendChild(sectionEl);
            });
            
            // Re-inicializar iconos de Lucide
            lucide.createIcons();
        }

        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            saveAndRender();
        });

    </script>
</body>
</html>
